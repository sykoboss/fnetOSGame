using System;
using System.Collections.Generic;
using System.IO;
using UnityEngine;

internal static class PortExploits
{
    private const int EXE_FILE_LENGTH = 500;
    public static List<int> portNums;
    public static List<int> exeNums;
    public static Dictionary<int, string> services;
    public static Dictionary<int, string> cracks;
    public static Dictionary<int, string> crackExeData;
    public static Dictionary<int, bool> needsPort;
    public static List<string> passwords;
    public static int[] totPortPC = {22,21,25,80};
    public static int[] totPortSV = {22,21,25,80,443,220};

    public static void populate()
    {
        portNums = new List<int>(64);
        exeNums = new List<int>(64);
        services = new Dictionary<int, string>(64);
        cracks = new Dictionary<int, string>(64);
        needsPort = new Dictionary<int, bool>(64);
        crackExeData = new Dictionary<int, string>(64);
        var random1 = new System.Random(17021990);
        var random2 = Utils.random;
        Utils.random = random1;

        /* Port Nums:
         * 22   = SSH
         * 21   = FTP
         * 25   = SMTP Mail Server
         * 80   = HTTP Web Server
         * 443  = HTTPS/SSL
         * 220  = IMAP3 Host
         */

        //SSH hacker
        portNums.Add(22);
        exeNums.Add(22);
        services[22] = "SSH";
        cracks[22] = "sshcrack.exe";
        needsPort[22] = true;
        crackExeData[22] = Computer.generateBinaryString(500);

        //FTP hacker
        portNums.Add(21);
        exeNums.Add(21);
        services[21] = "FTP Server";
        cracks[21] = "ftpbounce.exe";
        needsPort[21] = true;
        crackExeData[21] = Computer.generateBinaryString(500);

        //SMTP hacker
        portNums.Add(25);
        exeNums.Add(25);
        services[25] = "SMTP MailServer";
        cracks[25] = "smtpbreak.exe";
        needsPort[25] = true;
        crackExeData[25] = Computer.generateBinaryString(500);

        //HTTP hacker
        portNums.Add(80);
        exeNums.Add(80);
        services[80] = "HTTP WebServer";
        cracks[80] = "httpworm.exe";
        needsPort[80] = true;
        crackExeData[80] = Computer.generateBinaryString(500);

        //SQL hacker
        portNums.Add(443);
        exeNums.Add(443);
        services[443] = "SSL Server";
        cracks[443] = "sslcorrupt.exe";
        needsPort[443] = true;
        crackExeData[443] = Computer.generateBinaryString(500);

        //IMAP hacker
        portNums.Add(220);
        exeNums.Add(220);
        services[220] = "IMAP3 Host";
        cracks[220] = "imapscan.exe";
        needsPort[220] = true;
        crackExeData[220] = Computer.generateBinaryString(500);

        //Decypher tool
        exeNums.Add(9);
        services[9] = "Decypher";
        cracks[9] = "decypher.exe";
        needsPort[9] = false;
        crackExeData[9] = Computer.generateBinaryString(500);


        var streamReader = new StreamReader("Assets/Resources/passwords.txt");
        var str = streamReader.ReadToEnd();
        streamReader.Close();
        passwords = new List<string>(str.Replace("\n", " ").Replace("\r", "").Split(' ', '\t', '\n'));
        Utils.random = random2;
    }

    public static string getRandomPassword()
    {
        return passwords[Utils.random.Next(passwords.Count)];
    }
}